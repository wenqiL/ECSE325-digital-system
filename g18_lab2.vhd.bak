library IEEE;
use IEEE.STD_LOGIC_1164.ALL;
use IEEE.NUMERIC_STD.ALL;
entity g18_lab2 is
	Port (	x					: in std_logic_vector (8 downto 0);--first input
				y					: in std_logic_vector (8 downto 0);--second input
				N					: in std_logic_vector (9 downto 0);--total number of inputs
				clk				: in std_logic;--clock
				rst				: in std_logic;--asynchronous active-high reset
				mac				: out std_logic_vector (19 downto 0);--output of MAC units
				ready				: out std_logic);--denotes the validity of the mac signal
end g18_lab2;

architecture MAC of g18_lab2 is 
signal count: integer range 0 to 511;--2^9-1
signal mac_signal: std_logic_vector (9 downto 0);
begin
	macunit: process(clk)
	begin
		if rising_edge(clk) then
			if rst = '1' then mac_signal <= (others => '0');
			else 
				if count > 0 then 
					mac_signal <= std_logic_vector(signed(mac_signal) + signed(x)*signed(y));
					count <= count - 1;
				else
					ready <= '1';
				end if;--if mac_signal
			end if; --if rst
		end if; --if clk
	end process;
	mac <= mac_signal;
end MAC;